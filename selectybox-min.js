/* Selectybox 1.0  -- (c) 2012-2015 Hugsmiðjan ehf. - MIT/GPL   @preserve */
!function(){"use strict";var c,e=window,o=!!e.addEventListener,u=function(e,t){var s="add"===t,n=o?(s?"add":"remove")+"EventListener":(s?"at":"de")+"tachEvent",r=o?"":"on",i=e.select;i[n](r+"change",e._$refresh),i[n](r+"keyup",e._$refresh),i[n](r+"focus",e._$focus),i[n](r+"blur",e._$blur)},f=function(e,t,s){for(var n in t)e.style[n]=s?"":t[n]},d="templ getButton focusClass disabledClass emptyClass emptyVal text selectCSS".split(" "),l="_$refresh _$focus _$blur select container button".split(" "),p=function(e,t){var s=this,n=p.getWidget(e);if(n&&(n.destroy(),s=n),!(s instanceof p))return new p(e,t);if(t){for(var r,i=0;r=d[i++];)null!=t[r]&&(s[r]=t[r]);t=null}(c=c||document.createElement("div")).innerHTML=s.templ.replace(/^[^<]+/,"");var o=s.container=c.firstChild;o.style.position="relative",s.button=s.getButton(),(s.select=e).parentNode.insertBefore(o,e),o.insertBefore(e,s.button.nextSibling),e.style.opacity=1e-4,f(e,s.selectCSS),s._$refresh=function(){setTimeout(function(){s.refresh()},0)};var l=o.classList;s._$blur=function(){l.remove(s.focusClass)};var a=!(s._$focus=function(){l.add(s.focusClass)});return s._$able=function(){e.disabled!==a&&(a=e.disabled,l[a?"add":"remove"](s.disabledClass))},u(s,"add"),s._isEmpty=!1,s.refresh(),e.$selectybox=s,n?s:void 0};p.prototype={templ:'<span class="selecty"><span class="selecty-button"/></span>',getButton:function(){return this.container.firstChild},focusClass:"focused",disabledClass:"disabled",emptyClass:"emptyvalue",emptyVal:"     ",text:function(e){return e},selectCSS:{position:"absolute",bottom:0,left:0,width:"100%",height:"100%",top:"auto",right:"auto",margin:0,padding:0,border:0},refresh:function(){this._$able(),this.val()},val:function(e){var t=this,s=t.select;if(null!=e){e+="";for(var n,r=0;n=s.options[r++];)if(n.value===e){n.selected=!0;break}}var i=s.options[s.selectedIndex],o=!i.value;o!==t._isEmpty&&(t._isEmpty=o,t.container.classList[o?"add":"remove"](t.emptyClass)),t.button.innerHTML=t.text(i.text.replace(/</g,"&lt;"))||t.emptyVal},disable:function(e){this.select.disabled=!1!==e,this._$able()},destroy:function(){var e=this,t=e.select,s=e.container,n=s.parentNode;n.insertBefore(t,s),n.removeChild(s),u(e,"remove"),t.style.opacity="",f(t,e.selectCSS,!0),t.$selectybox="";for(var r=d.concat(l),i=r.length;i--;)delete e[r[i]]}},p.jQueryPlugin=function(n){n.fn.selectybox=function(s,t){var e=this;if(e[0]){if("string"!=typeof s)return(s=s||{}).text=s.text||function(e){return n(this.container).toggleClass("selecty-empty",!n(this.select).val()),e},e.pushStack(e.filter("select").map(function(e,t){return p(t,s).container}));if("widget"===s)return p.getWidget(e[0]);/^(?:refresh|val|destroy)$/.test(s)&&e.each(function(){var e=p.getWidget(this);e&&e[s](t)})}return e}},p.getWidget=function(e){return e.$selectybox},"object"==typeof module&&module.exports?module.exports=p:e.Selectybox=p;var t=e.jQuery;t&&!t.fn.selectybox&&p.jQueryPlugin(t)}();
